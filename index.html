<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PFV — Test</title>
  <style>body{font-family:system-ui;margin:24px;max-width:900px}</style>
</head>
<body>
  <h1>PFV — Test connexion Supabase</h1>
  <div id="status">⏳ Chargement du script…</div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const statusEl = document.getElementById('status');
    function show(m){ statusEl.textContent = m; console.log(m); }
    show('📦 Librairie chargée');

    // ⬇️ METS TES VALEURS ICI
    const SUPABASE_URL = "https://aoidadxujanxpxctbyvb.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFvaWRhZHh1amFueHB4Y3RieXZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzMDYyNzYsImV4cCI6MjA3NDg4MjI3Nn0.Iaf6J_KzUzRNddUE6Mq6xTJW0xKc7eR6FU3OtW2CwHw";

    try{
      if(!SUPABASE_URL.startsWith('https://') || !SUPABASE_URL.includes('.supabase.co')) {
        show('❌ SUPABASE_URL invalide: ' + SUPABASE_URL);
      } else {
        const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        show('🔎 Test SELECT sur table "decedents"...');
        (async ()=>{
          const { data, error } = await sb.from('decedents').select('*').limit(1);
          if(error){ show('❌ Erreur Supabase: ' + error.message); }
          else { show('✅ OK, ' + (data?.length||0) + ' ligne(s) lues.'); }
        })();
      }
    } catch(e){ show('❌ Erreur JS: ' + (e?.message||e)); }

    // Attrape toute erreur JS non gérée
    window.onerror = (msg,src,ln,col,err)=>{ show('❌ window.onerror: '+msg); };
  </script>
</body>
</html>
